<div class="dashboard-container">
  <h3 class="dashboard-title"><%- currentUser.username %>'s Dashboard</h3>

  <a href="/artisian/addProd" class="add-product-container">
    <p class="add-product-text">Add Products</p>
    <span class="add-product-btn">
      <i class="fa-solid fa-plus"></i>
    </span>
  </a>


  <div class="products-section">
    <h4>My Products</h4>
    <div class="products-grid">
      <% if(products && products.length> 0){ %>
        <% products.forEach(product=> { %>
          <div class="product-card">
            <div class="product-img">
              <img src="<%= product.image %>" alt="<%= product.name %>">
              <p class="img-name">
                <%= product.name %>
              </p>
            </div>
            <div class="product-details">
              <p>Price: â‚¹<%= product.price %>
              </p>
              <p>Quantity: <%= product.quantity %>
              </p>
              <a class="prod-details-btn" href="/product/<%= product._id %>">More details</a>

            </div>

          </div>
          <% }) %>
            <% } else { %>
              <p class="no-products">No products yet.</p>
              <% } %>
    </div>
  </div>
  <div class="products-section">
    <h4>Customer Orders</h4>
    <a href="/artisian/orders" class="add-product-container">
      <p class="add-product-text">My Orders</p>
      <span class="add-product-btn">
        <i class="fa-solid fa-box"></i>
      </span>
    </a>
  </div>


  <!-- DELETE ACCOUNT SECTION -->
  <div class="delete-account-section text-center mt-5">
    <form action="/artisian/<%= currentUser._id %>/generateStory" method="POST">
    <button type="submit" class="tryon-btn">Generate Your Story Page</button>
    
  </form>
    <form id="deleteAccountForm" action="/artisian/deleteAccount" method="POST">
      <button type="button" id="deleteAccountBtn" class="prod-del-btn"
        style="border: none; background-color: rgb(231, 58, 58); color: white; padding: 10px 20px; border-radius: 8px; font-weight: 600;">
        Delete My Account
      </button>
    </form>
  </div>

  <script>
    document.getElementById("deleteAccountBtn").addEventListener("click", function (e) {
      Swal.fire({
        title: "Are you sure?",
        text: "Your account and all related data (orders, products, etc.) will be permanently deleted!",
        icon: "warning",
        showCancelButton: true,
        confirmButtonText: "Yes, Delete it",
        cancelButtonText: "Cancel",
        confirmButtonColor: "#e73a3a",
        cancelButtonColor: "#6c757d",
        reverseButtons: true,
      }).then((result) => {
        if (result.isConfirmed) {
          document.getElementById("deleteAccountForm").submit();
        }
      });
    });
  </script>

</div>